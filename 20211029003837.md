# ECS vs k8s

https://qiita.com/hareku/items/a46d58f6f60e57157bf6

k8s より AWS ECS を使うべきという記事があった

# k8s の欠点

- 複雑
  - マイクロサービスには適するが
  - 学習コストが高い
  - 周辺ツールの把握も必要

# ECS を使う理由
- k8sよりは単純
- AWSへのベンダーロックインの可能性は？

# 共通点
Docker コンテナオーケストレーションツール

# 相違点

k8s は google の内部プロジェクト Borg をオープンソース化したもの

AWS ECS は k8s の様々な概念をなくしたライトなツール
タスク定義を指定すれば ECS がマネージドに管理すると言うだけ

# k8s の懸念

- 過剰な権限管理(for service, team)
  - Namespace 毎に細かく権限
    - マイクロサービスチームが自律的に運用することが可能になる
  - モノリシックサービスを1アカウントで運用するケースでは無用の長物
    - そのようなサービスではチームにk8sの基礎を学ばせるのも無駄

- インフラの属人化
  - 高度に抽象化されたAPI
  - 学習コスト
  - 周辺ツールの乱立機 -> 学習時間泥棒(すぐにベストプラクティスが変わる)

- カナリアデプロイの必要性
  - CDツール Spinnaker
    - 導入にハマりやすい
    - 構築、運用知識も必要
  - 多くの場合は ブルー・グリーンデプロイで十分
    - カナリアデプロイを使うほどデプロイを恐れている状態は不健全
  - AWSだとマネージドなデプロイサービスの CodeDeploy がある
    - CodeDeploy はブルー・グリーンデプロイメントをサポート
    - 運用・構築の手間なし

# AWS AppMesh の登場

k8s で言うところの Istio, Envoy

ECSでは今までサービスメッシュを導入するのが難しかったが、マイクロサービス管理基盤の
AWS App Mesh が出たことで差が縮まりつつある

マネージドなサービスメッシュを導入することで、構築運用の手間を減らせる

# 非ベンダーロックインであるべき？

k8s は特定のベンダーに依存しない(GCP GKE でも AWS EKS でも)
ECS は AWS 前提

ベンダー依存はECSを使わない理由になりうるが、
ベンダーロックはある程度避けられないという現実はある

# 周辺ツールの乱立機

ECSを使う場合、アプリ設定・CD構築までTerraformで完結

Kubernetesの場合、Helm, Kustomize, YAML, Spinnaker(カナリアデプロイが必要なら)を
自前でセットアップする必要がある。
YAMLだと管理ツールが多くてとっつきづらいという意見も

# 結論

ECSで十分ならECSで行くべし
k8sはオーバーキルな場合もある

# 個人の感想
仕事でもECS使ってる所あるし、k8sは複雑そう
モノリシックな個人サービスならECSで十分かな



